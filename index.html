<html>
    <head>
        <style>
            body div {
                padding: 10px;
                margin: auto;
            }
        </style>
        <script>
            var org_key = {
                "hewlettpackardnonproduction1u51hay96": "xx17ba35e7-e80f-422a-8f49-5edb1352e95f",
                "hewlettpackardnonproduction2mogyl6nm": "xxb6c7566e-2d1d-4e0f-ac0f-6cd8855f4b45",
                "hewlettpackardproductioniwmg9b9w": "xxe1afc9f5-133a-4b7e-bb57-7c33c7c5fa6e"
            }
            var config = {};
            function doSearch(){
                debugger;
                var sub = document.getElementById('subject').value;
                var matches = [...sub.matchAll(/(MSa20\d{2}[^\s]*)|EVA\d{4}|Nimble|nimble|FlexFabric|C\d{4}|ML\s\d{3}\sG\d|SNMPv\d*|HP\s\d{3,4}|Proliant|DL\d{3}\S*|SureStore|ProCurve|MSA\s?\d{4}|ML\d{3}|CentOS\d{1,2}|SimpliVity|ILO/gi)];
                matches = matches.flat();
                matches = matches.filter(function( element ) {
                    return element !== undefined;
                 });
                config["org"] = document.getElementById('org').value;
                config["apiKey"] = org_key[config["org"]];
                config["subject"] = document.getElementById('subject').value;
                config["desc"] = document.getElementById('desc').value;
                config["productName"] = matches.join(";");
                console.log(JSON.stringify(config));
                localStorage.setItem("coveoConfig",JSON.stringify(config));
                window.location.replace('http://'+window.location.host+'/search');
            }
        </script>
    </head>
    <body>
        <div>
            <div>
                <label for="org">Coveo Org : </label>
                <select id="org" name="org">
                    <option value="hewlettpackardproductioniwmg9b9w">Prod</option>
                    <option value="hewlettpackardnonproduction1u51hay96">Non-Prod 1</option>
                    <option value="hewlettpackardnonproduction2mogyl6nm">Non-Prod 2</option>
                </select>
            </div>
            <div>
                <label for="subject">Subject : </label>
                <input type="text" id="subject" name="subject" style="width: 100%;"></input>
            </div>
            <div>
                <label for="desc">Description : </label>
                <input type="text" id="desc" name="desc" style="width: 100%;"></input>
            </div>
            <div>
                <button id="search" onclick="doSearch()">Search</button>
            </div>
        </div>
    </body>
</html>